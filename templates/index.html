<!doctype html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <link rel="shortcut icon"
        href="https://037c96109eafecbaffbb36cdbe21d279.s3-eu-west-1.amazonaws.com/images/cryptocoin-ripple-base.png"
        type="image/x-icon">

  <style type="text/css">
    table {
      font-size: 86%;
    }
    caption{
      caption-side: top;
      padding: 0;
    }
  </style>

  <title>KClient</title>
</head>

<body>

<div class="container">
  <br/>

  <div class="row">
    <div class="col-md-6">
      <table class="table table-striped table-bordered table-sm">
        <caption>ETH Tick at {{ at }}</caption>
        <thead>
        <tr>
          <th>Buy</th>
          <th>Sell</th>
          <th>Low</th>
          <th>High</th>
          <th>Last</th>
          <th>Amount</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td>{{ eth_tick.ticker.buy|currency }}</td>
          <td>{{ eth_tick.ticker.sell|currency }}</td>
          <td>{{ eth_tick.ticker.low|currency }}</td>
          <td>{{ eth_tick.ticker.high|currency }}</td>
          <td>{{ eth_tick.ticker.last|currency }}</td>
          <td>{{ eth_tick.ticker.vol }}</td>
        </tr>
        </tbody>
      </table>
    </div>
    <div class="col-md-6">
       <table class="table table-striped table-bordered table-sm">
        <caption>Coins</caption>
        <thead>
        <tr>
          {% for account in actives %}
            {% if account.balance != '0.0' %}
              <td>{{ account.currency|upper }}</td>
            {% endif %}
          {% endfor %}
        </tr>
        </thead>
        <tbody>
        <tr>
          {% for account in actives %}
            {% if account.balance != '0.0' %}
              <td>{{ account.balance }}</td>
            {% endif %}
          {% endfor %}
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div id="chart-container" style="height: 400px; min-width: 310px"></div>
    </div>
  </div>

  <br>

  <div class="row">
    <div class="col-md-4">
      <table class="table table-striped table-bordered table-sm table-hover">
        <caption>Logs</caption>
        <thead>
        <tr>
          <th>At</th><th>Signal</th><th>act</th><th>Status</th><th>Cmnt</th>
        </tr>
        </thead>
        <tbody>
        {% for log in logs %}
        <tr>
          <td>{{ log.date|logdate }}</td>
          <td>{{ log.signal }}</td>
          <td>{{ log.action }}</td>
          <td>{{ log.status }}</td>
          <td>{{ log.comment }}</td>
        </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="col-md-4">
      <table class="table table-striped table-bordered table-sm">
        <caption>Trades history</caption>
        <thead>
        <tr>
          <th>Date</th>
          <th>Price</th>
          <th>Vol</th>
          <th>Funds</th>
        </tr>
        </thead>
        <tbody>
        {% for deal in deals %}
            <tr {% if deal.side=='ask' %} class="table-info" {% else %}class="table-danger"{% endif %}>
              <td>
                {{ deal.created_at|shortdate }}
                {% if deal.side == 'ask' %}
                    <img src="https://kuna.io/assets/icons/default/trade_buy-fbdde88afadf0e5b9e20bf64efd2402648b529656e7cdc8cbd8b53e96f28e869.png">
                {% else %}
                    <img src="https://kuna.io/assets/icons/default/trade_sell-88a76cf69aea3ee9821941ec46582607ad870fb27e7dbbaca37e75cbba7dbf35.png">
                {% endif %}
              </td>
              <td> {{ deal.price|currency }}</td>
              <td> {{ deal.volume }}</td>
              <td> {{ deal.funds|currency }}</td>
            </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="col-md-4">
      <table class="table table-striped table-bordered table-sm">
        <caption>Active Orders</caption>
        <tbody>
        {% for order in orders %}
        <tr>
          <td>
            {{ order }}
          </td>
        </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>

<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://code.highcharts.com/stock/highstock.js"></script>
<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>

<script type="text/javascript">
    $(document).ready(function (){

        Highcharts.theme = {
        colors: ['#2b908f', '#90ee7e', '#f45b5b', '#7798BF', '#aaeeee', '#ff0066',
                 '#eeaaee', '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'],
   chart: {
      backgroundColor: {
         linearGradient: { x1: 0, y1: 0, x2: 1, y2: 1 },
         stops: [
            [0, '#2a2a2b'],
            [1, '#3e3e40']
         ]
      },
      style: {
         fontFamily: '\'Unica One\', sans-serif'
      },
      plotBorderColor: '#606063'
   },
   title: {
      style: {
         color: '#E0E0E3',
         textTransform: 'uppercase',
         fontSize: '20px'
      }
   },
   subtitle: {
      style: {
         color: '#E0E0E3',
         textTransform: 'uppercase'
      }
   },
   xAxis: {
      gridLineColor: '#707073',
      labels: {
         style: {
            color: '#E0E0E3'
         }
      },
      lineColor: '#707073',
      minorGridLineColor: '#505053',
      tickColor: '#707073',
      title: {
         style: {
            color: '#A0A0A3'

         }
      }
   },
   yAxis: {
      gridLineColor: '#707073',
      labels: {
         style: {
            color: '#E0E0E3'
         }
      },
      lineColor: '#707073',
      minorGridLineColor: '#505053',
      tickColor: '#707073',
      tickWidth: 1,
      title: {
         style: {
            color: '#A0A0A3'
         }
      }
   },
   tooltip: {
      backgroundColor: 'rgba(0, 0, 0, 0.85)',
      style: {
         color: '#F0F0F0'
      }
   },
   plotOptions: {
      series: {
         dataLabels: {
            color: '#B0B0B3'
         },
         marker: {
            lineColor: '#333'
         }
      },
      boxplot: {
         fillColor: '#505053'
      },
      candlestick: {
         lineColor: 'white'
      },
      errorbar: {
         color: 'white'
      }
   },
   legend: {
      itemStyle: {
         color: '#E0E0E3'
      },
      itemHoverStyle: {
         color: '#FFF'
      },
      itemHiddenStyle: {
         color: '#606063'
      }
   },
   credits: {
      style: {
         color: '#666'
      }
   },
   labels: {
      style: {
         color: '#707073'
      }
   },

   drilldown: {
      activeAxisLabelStyle: {
         color: '#F0F0F3'
      },
      activeDataLabelStyle: {
         color: '#F0F0F3'
      }
   },

   navigation: {
      buttonOptions: {
         symbolStroke: '#DDDDDD',
         theme: {
            fill: '#505053'
         }
      }
   },

   // scroll charts
   rangeSelector: {
      buttonTheme: {
         fill: '#505053',
         stroke: '#000000',
         style: {
            color: '#CCC'
         },
         states: {
            hover: {
               fill: '#707073',
               stroke: '#000000',
               style: {
                  color: 'white'
               }
            },
            select: {
               fill: '#000003',
               stroke: '#000000',
               style: {
                  color: 'white'
               }
            }
         }
      },
      inputBoxBorderColor: '#505053',
      inputStyle: {
         backgroundColor: '#333',
         color: 'silver'
      },
      labelStyle: {
         color: 'silver'
      }
   },

   navigator: {
      handles: {
         backgroundColor: '#666',
         borderColor: '#AAA'
      },
      outlineColor: '#CCC',
      maskFill: 'rgba(255,255,255,0.1)',
      series: {
         color: '#7798BF',
         lineColor: '#A6C7ED'
      },
      xAxis: {
         gridLineColor: '#505053'
      }
   },

   scrollbar: {
      barBackgroundColor: '#808083',
      barBorderColor: '#808083',
      buttonArrowColor: '#CCC',
      buttonBackgroundColor: '#606063',
      buttonBorderColor: '#606063',
      rifleColor: '#FFF',
      trackBackgroundColor: '#404043',
      trackBorderColor: '#404043'
   },

   // special colors for some of the
   legendBackgroundColor: 'rgba(0, 0, 0, 0.5)',
   background2: '#505053',
   dataLabelsColor: '#B0B0B3',
   textColor: '#C0C0C0',
   contrastTextColor: '#F0F0F3',
   maskColor: 'rgba(255,255,255,0.3)'
};

        // Apply the theme
        Highcharts.setOptions(Highcharts.theme);

        Highcharts.stockChart('chart-container', {

        chart: {
            zoomType: 'x'
        },

        rangeSelector: {
             buttons: [
                 {
                     type: 'hour',
                     count: 1,
                     text: '1h'
                 },
                 {
                     type: 'hour',
                     count: 4,
                     text: '4h'
                 },
                 {
                     type: 'day',
                     count: 1,
                     text: '1D'
                 },
                 {
                     type: 'month',
                     count: 1,
                     text: '1M'
                 },
                 {
                     type: 'all',
                     count: 1,
                     text: 'All'
                 }
                 ],
            selected: 1
        },

        title: {
            text: 'ETH to USD Price'
        },

        series: [{
            name: 'ETH',
            data: {{ data|safe }},
            tooltip: {
                valueDecimals: 0
            }
           },
           {
            name: 'SMAVG',
            data: {{ data_s|safe }},
            tooltip: {
                valueDecimals: 0
            }
           },
        {
            name: 'LMAVG',
            data: {{ data_l|safe }},
            tooltip: {
                valueDecimals: 0
            }
           }
        ]
    });

    })
</script>
</body>
</html>